{"version":3,"sources":["../../../src/js/review/ArrayField.jsx"],"names":["Element","Scroll","scroller","ArrayField","props","handleNewItemTitleMounted","element","focus","arrayData","Array","isArray","state","items","editing","map","handleAdd","bind","handleSave","handleSetData","scrollToTop","scrollToRow","isLocked","newProps","newState","length","setState","index","schema","additionalItems","setTimeout","scrollTo","path","window","Forms","scroll","duration","delay","smooth","offset","id","status","concat","getItemSchema","undefined","definitions","indexToRemove","formData","filter","val","setData","data","newArray","newEditingArray","uiSchema","pageTitle","formContext","uiOptions","fieldName","title","reviewTitle","arrayPageConfig","pageKey","itemCountLocked","itemsNeeded","minItems","addAnotherDisabled","maxItems","Infinity","item","isLast","isEditing","showReviewButton","itemSchema","itemTitle","itemName","onBlur","handleEdit","handleRemove","React","Component","propTypes","PropTypes","object","isRequired","string","array"],"mappings":"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","file":"ArrayField.js","sourcesContent":["import PropTypes from 'prop-types';\nimport React from 'react';\nimport _ from 'lodash/fp';\nimport Scroll from 'react-scroll';\n\nimport {\n  getDefaultFormState\n} from '@department-of-veterans-affairs/react-jsonschema-form/lib/utils';\n\nimport SchemaForm from '../components/SchemaForm';\nimport { focusElement } from '../utilities/ui';\n\nconst Element = Scroll.Element;\nconst scroller = Scroll.scroller;\n\n/* Growable table (Array) field on the Review page\n *\n * The idea here is that, because our pattern for growable tables on the review\n * page is that each item can be in review or edit mode, we will treat each item\n * as its own form page and this component will handle the edit/review states and\n * make sure data is properly updated in the Redux store\n */\nclass ArrayField extends React.Component {\n  constructor(props) {\n    super(props);\n    // In contrast to the normal array field, we donâ€™t want to add an empty item\n    // and always show at least one item on the review page\n    const arrayData = Array.isArray(props.arrayData) ? props.arrayData : null;\n    this.state = {\n      items: arrayData || [],\n      editing: (this.props.arrayData || []).map(() => false)\n    };\n    this.handleAdd = this.handleAdd.bind(this);\n    this.handleSave = this.handleSave.bind(this);\n    this.handleSetData = this.handleSetData.bind(this);\n    this.scrollToTop = this.scrollToTop.bind(this);\n    this.scrollToRow = this.scrollToRow.bind(this);\n    this.isLocked = this.isLocked.bind(this);\n  }\n\n  componentWillReceiveProps(newProps) {\n    if (newProps.arrayData !== this.props.arrayData) {\n      const arrayData = Array.isArray(newProps.arrayData) ? newProps.arrayData : [];\n      const newState = {\n        items: arrayData\n      };\n      if (arrayData.length !== this.state.items.length) {\n        newState.editing = arrayData.map(() => false);\n      }\n\n      this.setState(newState);\n    }\n  }\n\n  getItemSchema(index) {\n    const schema = this.props.schema;\n    if (schema.items.length > index) {\n      return schema.items[index];\n    }\n\n    return schema.additionalItems;\n  }\n\n  scrollToTop() {\n    setTimeout(() => {\n      // Hacky; wonâ€™t work if the array field is used in two pages and one isnâ€™t\n      //  a BasicArrayField nor if the array field is used in three pages.\n      scroller.scrollTo(`topOfTable_${this.props.path[this.props.path.length - 1]}${this.isLocked() ? '_locked' : ''}`, window.Forms.scroll || {\n        duration: 500,\n        delay: 0,\n        smooth: true,\n        offset: -60\n      });\n    }, 100);\n  }\n\n  scrollToRow(id) {\n    setTimeout(() => {\n      scroller.scrollTo(`table_${id}`, window.Forms.scroll || {\n        duration: 500,\n        delay: 0,\n        smooth: true,\n        offset: 0\n      });\n    }, 100);\n  }\n\n  /*\n   * Clicking edit on the item in review mode\n   */\n  handleEdit(index, status = true) {\n    this.setState(_.set(['editing', index], status, this.state), () => {\n      const id = `${this.props.path[this.props.path.length - 1]}_${index}`;\n      this.scrollToRow(id);\n      focusElement(`#table_${id}`);\n    });\n  }\n\n  /*\n   * Clicking Add Another in the header of the array field section\n   */\n  handleAdd() {\n    const newState = {\n      items: this.state.items.concat(getDefaultFormState(this.getItemSchema(this.state.items.length), undefined, this.props.schema.definitions) || {}),\n      editing: this.state.editing.concat(true)\n    };\n    this.setState(newState, () => {\n      this.scrollToRow(`${this.props.path[this.props.path.length - 1]}_${this.state.items.length - 1}`);\n    });\n  }\n\n  handleNewItemTitleMounted = element => {\n    if (element) {\n      element.focus();\n    }\n  }\n\n  /*\n   * Clicking Remove when editing an item\n   */\n  handleRemove(indexToRemove) {\n    const { path, formData } = this.props;\n    const newState = _.assign(this.state, {\n      items: this.state.items.filter((val, index) => index !== indexToRemove),\n      editing: this.state.editing.filter((val, index) => index !== indexToRemove),\n    });\n    this.setState(newState, () => {\n      this.props.setData(_.set(path, this.state.items, formData));\n      this.scrollToTop();\n    });\n  }\n\n  /*\n   * Called on any form data change.\n   *\n   * When data is changed, since weâ€™re only editing one array item at a time,\n   * we need to update the full pageâ€™s form data and call the Redux setData action\n   */\n  handleSetData(index, data) {\n    const { path, formData } = this.props;\n    const newArray = _.set(index, data, this.state.items);\n    this.setState({ items: newArray }, () => {\n      this.props.setData(_.set(path, newArray, formData));\n    });\n  }\n\n  /*\n   * Clicking Update in edit mode.\n   *\n   * This is only called if the form is valid\n   * and data is already saved through handleSetData, so we just need to change\n   * the edting state\n   */\n  handleSave(index) {\n    const newEditingArray = _.set(index, false, this.state.editing);\n    this.setState({ editing: newEditingArray }, () => {\n      this.scrollToTop();\n    });\n  }\n\n  isLocked() {\n    return this.props.uiSchema['ui:field'] === 'BasicArrayField';\n  }\n\n  render() {\n    const {\n      schema,\n      uiSchema,\n      path,\n      pageTitle,\n      formContext\n    } = this.props;\n\n    const uiOptions = uiSchema['ui:options'] || {};\n    const fieldName = path[path.length - 1];\n    const title = _.get('ui:title', uiSchema) || uiOptions.reviewTitle || pageTitle;\n    const arrayPageConfig = {\n      uiSchema: uiSchema.items,\n      pageKey: fieldName\n    };\n\n    // TODO: Make this better; itâ€™s super hacky for now.\n    const itemCountLocked = this.isLocked();\n    // Make sure we default to an empty array if the item count is locked and no\n    //  arrayData is passed (mysteriously)\n    const items = itemCountLocked ? (this.props.arrayData || []) : this.state.items;\n    const itemsNeeded = (schema.minItems || 0) > 0 && items.length === 0;\n    const addAnotherDisabled = items.length >= (schema.maxItems || Infinity);\n\n    return (\n      <div className={itemsNeeded ? 'schemaform-review-array-warning' : null}>\n        {title &&\n          <div className=\"form-review-panel-page-header-row\">\n            <h5 className=\"form-review-panel-page-header\">{title}</h5>\n            {itemsNeeded && <span className=\"schemaform-review-array-warning-icon\"/>}\n          </div>}\n        <div className=\"va-growable va-growable-review\">\n          <Element name={`topOfTable_${fieldName}${itemCountLocked ? '_locked' : ''}`}/>\n          {items.map((item, index) => {\n            const isLast = items.length === (index + 1);\n            const isEditing = this.state.editing[index];\n            const showReviewButton = !itemCountLocked && (!schema.minItems || items.length > schema.minItems);\n            const itemSchema = this.getItemSchema(index);\n            const itemTitle = itemSchema ? itemSchema.title : '';\n\n            if (isEditing) {\n              return (\n                <div key={index} className=\"va-growable-background\">\n                  <Element name={`table_${fieldName}_${index}`}/>\n                  <div className=\"row small-collapse schemaform-array-row\" id={`table_${fieldName}_${index}`}>\n                    <div className=\"small-12 columns va-growable-expanded\">\n                      {isLast\n                        // eslint-disable-next-line jsx-a11y/no-noninteractive-tabindex\n                        ? <h5 tabIndex=\"0\" ref={this.handleNewItemTitleMounted}>New {uiOptions.itemName || 'Item'}</h5>\n                        : null}\n                      <SchemaForm\n                        data={item}\n                        schema={itemSchema}\n                        uiSchema={arrayPageConfig.uiSchema}\n                        title={pageTitle}\n                        hideTitle\n                        name={fieldName}\n                        formContext={formContext}\n                        onBlur={this.props.onBlur}\n                        onChange={(data) => this.handleSetData(index, data)}\n                        onEdit={() => this.handleEdit(index, !isEditing)}\n                        onSubmit={() => this.handleSave(index)}>\n                        <div className=\"row small-collapse\">\n                          <div className=\"small-6 left columns\">\n                            <button className=\"float-left\">Update</button>\n                          </div>\n                          <div className=\"small-6 right columns\">\n                            {showReviewButton && <button type=\"button\" className=\"usa-button-secondary float-right\" onClick={() => this.handleRemove(index)}>Remove</button>}\n                          </div>\n                        </div>\n                      </SchemaForm>\n                    </div>\n                  </div>\n                </div>\n              );\n            }\n            return (\n              <div key={index} className=\"va-growable-background\">\n                <div className=\"row small-collapse\">\n                  <SchemaForm\n                    reviewMode\n                    data={item}\n                    schema={itemSchema}\n                    uiSchema={arrayPageConfig.uiSchema}\n                    title={itemTitle}\n                    name={fieldName}\n                    onChange={(data) => this.handleSetData(index, data)}\n                    onEdit={() => this.handleEdit(index, !isEditing)}\n                    onSubmit={() => this.handleSave(index)}>\n                    <div/>\n                  </SchemaForm>\n                </div>\n              </div>\n            );\n          })}\n          {itemsNeeded &&\n            <div className=\"usa-alert usa-alert-warning usa-alert-no-color usa-alert-mini\">\n              <div className=\"usa-alert-body\">\n                {_.get('ui:errorMessages.minItems', uiSchema) || 'You need to add at least one item.'}\n              </div>\n            </div>}\n          {title && !itemCountLocked &&\n            <button type=\"button\"\n              disabled={addAnotherDisabled}\n              className=\"edit-btn primary-outline\"\n              onClick={() => this.handleAdd()}>\n              {uiOptions.itemName ? `Add Another ${uiOptions.itemName}` : 'Add Another'}\n            </button>\n          }\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ArrayField;\n\nArrayField.propTypes = {\n  schema: PropTypes.object.isRequired,\n  uiSchema: PropTypes.object,\n  pageKey: PropTypes.string.isRequired,\n  path: PropTypes.array.isRequired,\n  formData: PropTypes.object,\n  arrayData: PropTypes.array,\n  pageTitle: PropTypes.string\n};\n"]}